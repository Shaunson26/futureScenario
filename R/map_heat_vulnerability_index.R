#' Map heat vulnerability index data to ordinal names
#'
#' 1 represents low exposure, low sensitivity or high adaptive capacity and 5
#' represents high exposure, high sensitivity or low adaptive capacity.
#'
#' @param x list, result from \code{get_heat_vulnerability_index}
#'
#' @export
map_heat_vulnerability_index <- function(x){

  scores <- x$features[[1]]$attributes[c('HVI', 'Expos_Indx', 'Sensi_Indx', 'AdapC_Indx')]

  values = c('low', 'low-moderate', 'moderate', 'moderate-high', 'high')

  label_map <-
    c('HVI' = 'Heat vulnerability index',
      'Expos_Indx' = "Exposure index",
      'Sensi_Indx' = 'Sensitivity index',
      'AdapC_Indx' = 'Adaptive capacity')

  out <- vector('list', length(scores))

  for(i in seq_along(scores)){

    in_var <- names(scores)[i]
    in_score <- scores[[i]]
    value_text <- ifelse(in_var %in% 'AdapC_Indx',
                         rev(values)[in_score],
                         values[in_score])

    out[[i]] <-
      list(label = unname(label_map[in_var]),
           value = in_score,
           value_text =  value_text)
  }

  names(out) <- names(scores)

  out

}
